<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deadcetera - Song Practice Workflow</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <!-- Logo placeholder - replace logo.png with your actual logo -->
            <img src="logo.png" alt="Deadcetera" class="logo" onerror="this.style.display='none'">
            <h1>üé∏ Deadcetera Practice Tool</h1>
            <p class="subtitle">Pick a song ‚Üí Find the best version ‚Üí Download ‚Üí Practice your part</p>
            
            <!-- Instrument Selector - Always Visible -->
            <div class="instrument-selector">
                <label for="instrumentSelect">I play:</label>
                <select id="instrumentSelect" class="instrument-dropdown">
                    <option value="bass">Bass</option>
                    <option value="rhythm_guitar">Rhythm Guitar</option>
                    <option value="lead_guitar">Lead Guitar</option>
                    <option value="keyboards">Keyboards</option>
                    <option value="vocals">Vocals</option>
                </select>
            </div>
        </header>

        <!-- Step 1: Song Selection -->
        <div class="step-card" id="step1">
            <div class="step-number">1</div>
            <h2>Choose Your Song</h2>
            <div class="search-box">
                <input 
                    type="text" 
                    id="songSearch" 
                    placeholder="Search for a song..." 
                    class="search-input"
                >
            </div>
            <div class="band-filters">
                <button class="filter-btn active" data-filter="all">All Songs</button>
                <button class="filter-btn" data-filter="GD">Grateful Dead</button>
                <button class="filter-btn" data-filter="JGB">Jerry Garcia Band</button>
                <button class="filter-btn" data-filter="WSP">Widespread Panic</button>
                <button class="filter-btn" data-filter="Phish">Phish</button>
            </div>
            <div class="song-dropdown" id="songDropdown">
                <!-- Songs populated here -->
            </div>
        </div>

        <!-- Step 2: Learning Resources (NEW!) -->
        <div class="step-card hidden" id="step2">
            <div class="step-number">2</div>
            <h2>Learning Resources</h2>
            <p class="step-description" id="resourcesSongTitle">Get tabs, chords, and lessons for this song</p>
            
            <div class="resources-container">
                <!-- Tab/Chart Section -->
                <div class="resource-section">
                    <h3>üìù <span id="tabTypeLabel">Tab/Chart</span></h3>
                    <div id="tabResourceContent">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Instructional Videos Section -->
                <div class="resource-section">
                    <h3>üé• Instructional Videos</h3>
                    <p class="resource-description">Save 1-2 lesson links (YouTube, etc.)</p>
                    <div id="lessonsResourceContent">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Reference Recordings Section -->
                <div class="resource-section">
                    <h3>üé∏ Reference Recordings</h3>
                    <p class="resource-description">Save favorite performances to reference</p>
                    <div id="referencesResourceContent">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <button class="primary-btn" id="continueToVersionsBtn" style="margin-top: 20px;">
                Continue to Version Selection ‚Üí
            </button>
        </div>

        <!-- Step 3: Version Selection (renumbered from Step 2) -->
        <div class="step-card hidden" id="step3">
            <div class="step-number">3</div>
            <h2>Top 5 Live Versions</h2>
            <p class="step-description">Based on community rankings and sound quality</p>
            <div id="versionsContainer">
                <!-- Top 5 versions populated here -->
            </div>
        </div>

        <!-- Step 4: Download (renumbered from Step 3) -->
        <div class="step-card hidden" id="step4">
            <div class="step-number">4</div>
            <h2>Download & Upload to Moises</h2>
            <div class="download-card">
                <div class="selected-info" id="selectedInfo">
                    <!-- Selected song and version info -->
                </div>
                <div class="action-buttons">
                    <button class="primary-btn smart-download-btn" id="smartDownloadBtn" style="background: #10b981;">
                        ‚ö° Smart Download (Just This Song!)
                    </button>
                    <button class="primary-btn" id="downloadBtn">
                        ‚¨áÔ∏è Download Full Show from Archive.org
                    </button>
                    <button class="primary-btn moises-btn" id="moisesBtn">
                        üéõÔ∏è Open Moises.ai Studio
                    </button>
                    <button class="primary-btn" id="setlistBtn" style="background: #48bb78;">
                        üìã View Setlist (Song Order & Timing)
                    </button>
                    <button class="primary-btn youtube-btn" id="youtubeSearchBtn" style="background: #ef4444;">
                        üé• Search YouTube for This Song
                    </button>
                </div>
                <div id="progressContainer" class="hidden" style="margin-top: 15px; padding: 15px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="spinner"></div>
                        <div>
                            <strong id="progressMessage">Processing...</strong>
                            <div style="margin-top: 5px; height: 8px; background: #dbeafe; border-radius: 4px; overflow: hidden;">
                                <div id="progressBar" style="height: 100%; background: #3b82f6; width: 0%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="workflow-guide">
                    <h3>üìã Your Practice Workflow:</h3>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 4px solid #48bb78;">
                            <strong>‚úÖ STEP 1: Download MP3</strong>
                            <p style="margin: 5px 0 0 0; color: #4a5568; font-size: 0.9em;">
                                Click "Download MP3" button above ‚Üí Find the file on Archive.org ‚Üí Right-click ‚Üí Save to Downloads
                            </p>
                        </div>
                        <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 4px solid #4299e1;">
                            <strong>‚¨ÜÔ∏è STEP 2: Upload to Moises</strong>
                            <p style="margin: 5px 0 0 0; color: #4a5568; font-size: 0.9em;">
                                Click "Open Moises.ai Studio" ‚Üí Click Upload ‚Üí Select your downloaded MP3
                            </p>
                        </div>
                        <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 4px solid #ed8936;">
                            <strong>‚öôÔ∏è STEP 3: Separate Stems</strong>
                            <p style="margin: 5px 0 0 0; color: #4a5568; font-size: 0.9em;">
                                Choose "6 Stems" separation ‚Üí Wait 1-2 minutes for AI processing
                            </p>
                        </div>
                        <div style="padding: 10px; background: white; border-radius: 6px; border-left: 4px solid #667eea;">
                            <strong>üé∏ STEP 4: Solo Your Part</strong>
                            <p style="margin: 5px 0 0 0; color: #4a5568; font-size: 0.9em;">
                                Click "Solo" on your instrument ‚Üí Adjust tempo ‚Üí Loop sections ‚Üí Practice!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 5: Part Selection Guide (renumbered from Step 4) -->
        <div class="step-card hidden" id="step5">
            <div class="step-number">5</div>
            <h2>Isolate Your Part in Moises</h2>
            <div class="parts-grid">
                <div class="part-card">
                    <div class="part-icon">üé§</div>
                    <h3>Vocals / Harmonies</h3>
                    <p>Solo the vocals track to learn melody and harmonies</p>
                </div>
                <div class="part-card">
                    <div class="part-icon">üé∏</div>
                    <h3>Jerry Garcia (Lead)</h3>
                    <p>Isolate lead guitar to learn solos and fills</p>
                </div>
                <div class="part-card">
                    <div class="part-icon">üé∏</div>
                    <h3>Bob Weir (Rhythm)</h3>
                    <p>Focus on rhythm guitar and chord progressions</p>
                </div>
                <div class="part-card">
                    <div class="part-icon">üé∏</div>
                    <h3>Phil Lesh (Bass)</h3>
                    <p>Learn Phil's melodic bass lines</p>
                </div>
                <div class="part-card">
                    <div class="part-icon">ü•Å</div>
                    <h3>Drums</h3>
                    <p>Practice the groove and fills</p>
                </div>
                <div class="part-card">
                    <div class="part-icon">üéπ</div>
                    <h3>Keyboards</h3>
                    <p>Isolate keys for atmospheric parts</p>
                </div>
            </div>
        </div>

        <!-- Reset Button -->
        <div class="reset-container hidden" id="resetContainer">
            <button class="reset-btn" onclick="resetWorkflow()">
                ‚Ü∫ Start Over with New Song
            </button>
        </div>
        
        <!-- YouTube Search Modal -->
        <div id="youtubeModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üé• Search YouTube</h2>
                    <button class="close-btn" onclick="closeYoutubeModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div id="youtubeSearchResults" class="youtube-results">
                        <!-- Results populated here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Add Resource Modal -->
        <div id="addResourceModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="addResourceTitle">Add Resource</h2>
                    <button class="close-btn" onclick="closeAddResourceModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <p id="addResourceInstructions"></p>
                    <input type="text" id="resourceUrlInput" class="search-input" placeholder="Paste URL here...">
                    <div id="urlPreviewContainer"></div>
                    <div style="display: flex; gap: 10px; margin-top: 15px; justify-content: flex-end;">
                        <button class="secondary-btn" onclick="closeAddResourceModal()">Cancel</button>
                        <button class="primary-btn" onclick="saveResource()">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>Made for Deadcetera | Data from Archive.org ‚Ä¢ Stem separation by Moises.ai</p>
    </footer>

    <script src="data.js"></script>
    <script src="audio-splitter.js"></script>
    <script src="app.js"></script>
</body>
</html>
